# 消息队列

## 消息队列有什么用？

- 异步处理任务
- 限流：将任务限制在队列中，按服务端的消费能力处理，防止所有数据涌向服务器
- 降低系统耦合：生产者-消费者模式，实现两个模块的解耦

## 使用消息队列带来的问题？

- 系统复杂性提高
- 数据一致性问题（消息重复、消息丢失）



## 有哪些队列模型？

### JMS中有两种，API的模型

- P2P 的队列模型
- Pub/Sub 发布订阅模型（广播），用topic作为主题发送给订阅该主题的消费者

### AMQP高级消息队列协议有5种，常用3种

基于不同交换机实现对应的队列模型：

- fanout 扇出：广播
- direct 订阅：根据路由key 发送对应的消息队列
- topic 通配符订阅：根据通配符描述的路由key发送对应消息队列
- headers ：根据消息头匹配 用的少